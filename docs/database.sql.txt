PASTE HERE: https://dbdiagram.io/d

////////////////////////////////////////////////////////////
//  APARTMENT MANAGEMENT SYSTEM (UTA-STYLE) â€” FULL SCHEMA
////////////////////////////////////////////////////////////

// 1. CLASSIFICATIONS
Table apartment_types {
  apt_type_id int [pk, increment]
  name varchar         // ex: BY_UNIT, BY_BEDROOM
  description varchar
}

// 2. COMMUNITIES (Meadow Run, etc.)
Table apartments {
  apartment_id int [pk, increment]
  apt_type_id int [not null]
  name varchar
  address varchar
  description text
  created_at timestamp
}
Ref: apartments.apt_type_id > apartment_types.apt_type_id

// 3. UNITS (The physical flat)
Table units {
  unit_id int [pk, increment]
  apartment_id int [not null]
  unit_number varchar              // "101", "220A"
  layout_type varchar              // "2B/2B"
  unit_lease_type varchar          // "room_based" or "unit_based"
  capacity int
  created_at timestamp
}
Ref: units.apartment_id > apartments.apartment_id

// 4. ROOMS (Bedrooms)
Table rooms {
  room_id int [pk, increment]
  unit_id int [not null]
  room_label varchar               // "A", "B"
  room_type varchar                // "Private", "Shared"
  gender_restriction varchar       // "Male", "Female", "Coed"
  room_status varchar              // "Ready", "Maintenance"
  created_at timestamp
}
Ref: rooms.unit_id > units.unit_id

// 5. USERS (Updated with UTA IDs)
Table users {
  user_id int [pk, increment]      // Internal System ID
  uta_id varchar(10) [unique, not null] // 10-digit Student ID
  net_id varchar [unique, not null]     // ex: abc1234 (Login Username)
  fName varchar
  mName varchar
  lName varchar
  email varchar [unique]
  password varchar
  phone varchar
  role varchar                     // student, admin, staff
  created_at timestamp
}

// 6. OCCUPANCY (Who physically lives where)
// Links User -> Room regardless of lease type
Table room_occupants {
  occupancy_id int [pk, increment]
  room_id int [not null]
  user_id int [not null]
  occupant_type varchar            // lease_holder, roommate, authorized_guest
  move_in date
  move_out date
  status varchar                   // current, past, pending_keys
  created_at timestamp
}
Ref: room_occupants.room_id > rooms.room_id
Ref: room_occupants.user_id > users.user_id

// 7. LEASES (The Financial Contract)
// Linked to Occupancy to handle "By-Unit" lease holders vs roommates
Table leases {
  lease_id int [pk, increment]
  occupancy_id int [not null]      // FK (Must be the Lease Holder)
  term_name varchar                // "Fall 2024", "Annual 24-25"
  lease_start date
  lease_end date
  rent_amount decimal
  security_deposit decimal         // OPTIMIZED
  payment_schedule varchar         // "Monthly", "Semester"
  status varchar                   // active, signed, terminated
  signed boolean
  signed_at timestamp
}
Ref: leases.occupancy_id > room_occupants.occupancy_id

// 8. PAYMENTS (Optimized)
Table payments {
  payment_id int [pk, increment]
  lease_id int [not null]
  amount decimal
  payment_type varchar             // RENT, DEPOSIT, LATE_FEE, UTILITY
  payment_method varchar           // CARD, ACH, CHECK
  transaction_ref varchar          // Stripe/Gateway ID
  status varchar                   // pending, paid, failed, overdue
  due_date date
  paid_at timestamp
}
Ref: payments.lease_id > leases.lease_id

// 9. MAINTENANCE (Optimized with Assignments)
Table maintenance_requests {
  request_id int [pk, increment]
  user_id int                      // Requester
  room_id int                      // Location
  assigned_staff_id int            // Who is fixing it? (FK to users)
  category varchar                 // plumbing, hvac, internet
  description text
  status varchar                   // open, in_progress, resolved
  priority varchar                 // low, high, emergency
  created_at timestamp
  resolved_at timestamp
}
Ref: maintenance_requests.room_id > rooms.room_id
Ref: maintenance_requests.user_id > users.user_id
Ref: maintenance_requests.assigned_staff_id > users.user_id

// 10. GROUPS (Roommate Chat/File Sharing)
Table roommate_groups {
  group_id int [pk, increment]
  unit_id int
  created_at timestamp
}

Table roommate_group_members {
  id int [pk, increment]
  group_id int [not null]
  user_id int [not null]
  joined_at timestamp
}
Ref: roommate_group_members.group_id > roommate_groups.group_id
Ref: roommate_group_members.user_id > users.user_id

// 11. DOCUMENTS (MongoDB Link)
Table lease_documents {
  doc_id int [pk, increment]
  lease_id int [not null]
  file_id varchar               // MongoDB ObjectId
  doc_type varchar              // "Signed Lease", "Addendum"
  created_at timestamp
}
Ref: lease_documents.lease_id > leases.lease_id